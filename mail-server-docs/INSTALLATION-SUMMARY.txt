â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                      â•‘
â•‘     ğŸ“§ SERVIDOR DE CORREO INSTALADO EXITOSAMENTE                    â•‘
â•‘                                                                      â•‘
â•‘     mail.sorteos.club (62.171.188.255)                              â•‘
â•‘     Fecha: 2025-11-17                                               â•‘
â•‘                                                                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… SERVICIOS INSTALADOS Y ACTIVOS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  âœ“ Postfix 3.8.6         (SMTP/MTA)
    - Puerto 25   (SMTP)
    - Puerto 465  (SMTPS - TLS implÃ­cito)
    - Puerto 587  (Submission - STARTTLS) â­ RECOMENDADO

  âœ“ Dovecot 2.3.21        (IMAP/POP3)
    - Puerto 993  (IMAPS)
    - Puerto 995  (POP3S)

  âœ“ OpenDKIM 2.11.0       (Firma Digital)
    - Firmando todos los correos salientes
    - Selector: default
    - Algoritmo: RSA-2048 + SHA-256

  âœ“ Fail2ban              (ProtecciÃ³n)
    - Jails activas: postfix, dovecot, sshd
    - Bantime: 1 hora (Postfix), 2 horas (Dovecot)

  âœ“ SnappyMail            (Webmail)
    - URL: https://webmail.sorteos.club
    - Pendiente: Configurar DNS para webmail

  âœ“ pflogsumm             (Monitoreo)
    - Reportes diarios a postmaster@sorteos.club


ğŸ“ CUENTAS DE CORREO CREADAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  1. noreply@sorteos.club      (Transaccional)
  2. info@sorteos.club          (Contacto general)
  3. soporte@sorteos.club       (Soporte tÃ©cnico)
  4. postmaster@sorteos.club    (AdministraciÃ³n)

  ğŸ“„ Credenciales completas en:
     /opt/Sorteos/mail-server-docs/mail-server-credentials.txt


ğŸ” SEGURIDAD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  âœ… TLS/SSL obligatorio en todos los puertos
  âœ… Certificados Let's Encrypt vÃ¡lidos (sorteos.club)
  âœ… AutenticaciÃ³n SASL activa
  âœ… DKIM firmando correos
  âœ… Fail2ban protegiendo contra ataques
  âœ… PTR configurado correctamente
  âœ… Protocolos seguros: TLS 1.2, TLS 1.3


ğŸ§ª PRUEBAS REALIZADAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  âœ… Entrega local de correos (Maildir)         100% OK
  âœ… Firma DKIM activa                          100% OK
  âœ… AutenticaciÃ³n SMTP puerto 587 + TLS        100% OK
  âœ… Dovecot autenticando usuarios              100% OK
  âœ… Fail2ban detectando intentos fallidos      100% OK


â³ PENDIENTE: CONFIGURACIÃ“N DNS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  ğŸ“ Registros DNS que DEBES configurar en Contabo:

  1. A       mail.sorteos.club               â†’ 62.171.188.255
  2. A       webmail.sorteos.club            â†’ 62.171.188.255
  3. TXT     sorteos.club (SPF)              â†’ v=spf1 +a +mx +ip4:62.171.188.255 ~all
  4. TXT     mail.sorteos.club (SPF)         â†’ v=spf1 a mx ip4:62.171.188.255 ~all
  5. TXT     default._domainkey.sorteos.club â†’ [ver dns-records file]
  6. TXT     _dmarc.sorteos.club             â†’ v=DMARC1; p=none; rua=mailto:postmaster@sorteos.club

  âš ï¸  NO cambies el MX hasta verificar que los correos salen bien!

  ğŸ“„ Registros DNS completos con ejemplos:
     /opt/Sorteos/mail-server-docs/dns-records-sorteos-club.txt


ğŸ“š DOCUMENTACIÃ“N GENERADA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  /opt/Sorteos/mail-server-docs/
    â”œâ”€â”€ README.md                           (Resumen ejecutivo)
    â”œâ”€â”€ mail-server-credentials.txt         (Todas las contraseÃ±as)
    â”œâ”€â”€ dns-records-sorteos-club.txt        (Registros DNS completos)
    â”œâ”€â”€ PLAYBOOK-MANTENIMIENTO.md           (GuÃ­a de administraciÃ³n)
    â””â”€â”€ dkim-backup/                        (Backup de claves DKIM)


ğŸš€ PRÃ“XIMOS PASOS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  1. Configurar registros DNS en Contabo (ver dns-records file)

  2. Esperar propagaciÃ³n DNS (1-2 horas)
     Verificar con: dig TXT sorteos.club +short

  3. Hacer prueba de envÃ­o a Gmail/Outlook
     Ver instrucciones en README.md

  4. Verificar headers: SPF=pass, DKIM=pass, DMARC=pass
     Gmail: "Mostrar original"

  5. Probar con https://www.mail-tester.com/
     Score objetivo: >8/10

  6. Solo entonces, cambiar MX a mail.sorteos.club

  7. Actualizar .env de la aplicaciÃ³n sorteos.club
     CONFIG_SMTP_HOST=mail.sorteos.club
     CONFIG_SMTP_PORT=587

  8. Reiniciar app: systemctl restart sorteos-api


ğŸ“Š COMANDOS ÃšTILES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  # Ver estado
  systemctl status postfix dovecot opendkim

  # Ver cola
  mailq

  # Logs en tiempo real
  tail -f /var/log/postfix.log

  # Ver IPs bloqueadas
  fail2ban-client status postfix

  # EstadÃ­sticas
  pflogsumm -d today /var/log/postfix.log


ğŸ“§ CONFIGURACIÃ“N SMTP PARA TU APP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Host:     mail.sorteos.club
  Port:     587
  User:     noreply@sorteos.club
  Password: [ver credentials.txt]
  TLS:      true (STARTTLS)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ‰ INSTALACIÃ“N COMPLETADA AL 100%
  âœ… SISTEMA FUNCIONANDO CORRECTAMENTE
  â³ SOLO FALTA CONFIGURAR DNS Y PROBAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

